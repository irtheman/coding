<!DOCTYPE html>
<!--
    So Simple Jekyll Theme 3.2.0
    Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
    Free for personal and commercial use under the MIT license
    https://github.com/mmistakes/so-simple-theme/blob/master/LICENSE
-->
<html lang="en-US" class="no-js">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  

  
    
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Retry Action | Software Design Blog</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Retry Action" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Let’s retry an action and maybe a function… Keeping in mind, this particular job had a specific rule of not allowing any third-party libraries. Everything had to be done adhoc. The Action Keeps Failing Challenge While working with the team, I often found that tasks would fail due to other problems outside our domain. Often this was due to the SQL server timing out which we couldn’t change. There were sometimes problems where service we were relying on was slow starting up; all of our services would sleep after a mere 5 minutes. We could just keep popping up the error notification and make the user resubmit but even I didn’t like doing that myself. I came up with an idea for going ahead and retrying until there was a definite point to give up. A Retry Function /// &lt;summary&gt; /// Retry a failed action /// &lt;/summary&gt; /// &lt;param name=&quot;action&quot;&gt;Action to perform&lt;/param&gt; /// &lt;param name=&quot;numberOfRetries&quot;&gt;Number of retries&lt;/param&gt; /// &lt;param name=&quot;delayMs&quot;&gt;Delay between reties. Default is no delay.&lt;/param&gt; public static void RetryAction(Action action, int numberOfRetries, int delayMs = 0) { Exception? exception = null; int retries = 0; while (retries &lt; numberOfRetries) { try { action(); return; } catch (Exception ex) { // Ignore error exception = ex; retries++; } if (delayMs &gt; 0) { Task.Delay(delayMs).Wait(); } } throw exception!; } Example public static void ThisMightFail() { const int notAllowed = 1; Console.Write(&quot;Enter a number: &quot;); var input = int.Parse(Console.ReadLine() ?? &quot;0&quot;); if (input == notAllowed) { Console.WriteLine($&quot;You number must not be {notAllowed}&quot;); throw new ArgumentException($&quot;You number must not be {notAllowed}&quot;); } Console.Write(&quot;Number accepted!&quot;); } RetryAction(ThisMightFail /* The action to retry */, 5 /* 5 retries */, 500 /* 1/2 second delay */); What It Looks Like If It Fails Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Message: Your number must not be 1 Source: RetryActionDemo HelpLink: StackTrace: at RetryActionDemo.Program.Main(String[] args) in .... What It Looks Like If It Succeeds Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 2 Number accepted! Okay, what about parameters and return values… public static int GetTheNumber(int notAllowed = 1) { Console.Write(&quot;Enter a number: &quot;); var input = int.Parse(Console.ReadLine() ?? &quot;0&quot;); if (input == notAllowed) { Console.WriteLine($&quot;You number must not be {notAllowed}&quot;); throw new ArgumentException($&quot;You number must not be {notAllowed}&quot;); } Console.Write(&quot;Number accepted!&quot;); return input; } /* This is a wrapper so we can pass a parameter */ public static int ThisMightFail2() { return GetTheNumber(3); } var res = RetryAction(ThisMightFail2 /* The action to retry */, 5 /* 5 retries */, 500 /* 1/2 second delay */); Console.WriteLine(res); The New RetryAction /// &lt;summary&gt; /// Retry a failed function /// &lt;/summary&gt; /// &lt;param name=&quot;fn&quot;&gt;Function to perform&lt;/param&gt; /// &lt;param name=&quot;numberOfRetries&quot;&gt;Number of retries&lt;/param&gt; /// &lt;param name=&quot;delayMs&quot;&gt;Delay between reties. Default is no delay.&lt;/param&gt; public static TResult? RetryAction&lt;TResult&gt;(Func&lt;TResult&gt; fn, int numberOfRetries, int delayMs = 0) { Exception? exception = null; int retries = 0; while (retries &lt; numberOfRetries) { try { return fn(); } catch (Exception ex) { // Ignore error exception = ex; retries++; } if (delayMs &gt; 0) { Task.Delay(delayMs).Wait(); } } throw exception!; } What It Looks Like If It Fails Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Message: Your number must not be 3 Source: RetryActionDemo HelpLink: StackTrace: at RetryActionDemo.Program.Main(String[] args) in .... What It Looks Like If It Succeeds Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 1 Number accepted! 1" />
<meta property="og:description" content="Let’s retry an action and maybe a function… Keeping in mind, this particular job had a specific rule of not allowing any third-party libraries. Everything had to be done adhoc. The Action Keeps Failing Challenge While working with the team, I often found that tasks would fail due to other problems outside our domain. Often this was due to the SQL server timing out which we couldn’t change. There were sometimes problems where service we were relying on was slow starting up; all of our services would sleep after a mere 5 minutes. We could just keep popping up the error notification and make the user resubmit but even I didn’t like doing that myself. I came up with an idea for going ahead and retrying until there was a definite point to give up. A Retry Function /// &lt;summary&gt; /// Retry a failed action /// &lt;/summary&gt; /// &lt;param name=&quot;action&quot;&gt;Action to perform&lt;/param&gt; /// &lt;param name=&quot;numberOfRetries&quot;&gt;Number of retries&lt;/param&gt; /// &lt;param name=&quot;delayMs&quot;&gt;Delay between reties. Default is no delay.&lt;/param&gt; public static void RetryAction(Action action, int numberOfRetries, int delayMs = 0) { Exception? exception = null; int retries = 0; while (retries &lt; numberOfRetries) { try { action(); return; } catch (Exception ex) { // Ignore error exception = ex; retries++; } if (delayMs &gt; 0) { Task.Delay(delayMs).Wait(); } } throw exception!; } Example public static void ThisMightFail() { const int notAllowed = 1; Console.Write(&quot;Enter a number: &quot;); var input = int.Parse(Console.ReadLine() ?? &quot;0&quot;); if (input == notAllowed) { Console.WriteLine($&quot;You number must not be {notAllowed}&quot;); throw new ArgumentException($&quot;You number must not be {notAllowed}&quot;); } Console.Write(&quot;Number accepted!&quot;); } RetryAction(ThisMightFail /* The action to retry */, 5 /* 5 retries */, 500 /* 1/2 second delay */); What It Looks Like If It Fails Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Message: Your number must not be 1 Source: RetryActionDemo HelpLink: StackTrace: at RetryActionDemo.Program.Main(String[] args) in .... What It Looks Like If It Succeeds Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 2 Number accepted! Okay, what about parameters and return values… public static int GetTheNumber(int notAllowed = 1) { Console.Write(&quot;Enter a number: &quot;); var input = int.Parse(Console.ReadLine() ?? &quot;0&quot;); if (input == notAllowed) { Console.WriteLine($&quot;You number must not be {notAllowed}&quot;); throw new ArgumentException($&quot;You number must not be {notAllowed}&quot;); } Console.Write(&quot;Number accepted!&quot;); return input; } /* This is a wrapper so we can pass a parameter */ public static int ThisMightFail2() { return GetTheNumber(3); } var res = RetryAction(ThisMightFail2 /* The action to retry */, 5 /* 5 retries */, 500 /* 1/2 second delay */); Console.WriteLine(res); The New RetryAction /// &lt;summary&gt; /// Retry a failed function /// &lt;/summary&gt; /// &lt;param name=&quot;fn&quot;&gt;Function to perform&lt;/param&gt; /// &lt;param name=&quot;numberOfRetries&quot;&gt;Number of retries&lt;/param&gt; /// &lt;param name=&quot;delayMs&quot;&gt;Delay between reties. Default is no delay.&lt;/param&gt; public static TResult? RetryAction&lt;TResult&gt;(Func&lt;TResult&gt; fn, int numberOfRetries, int delayMs = 0) { Exception? exception = null; int retries = 0; while (retries &lt; numberOfRetries) { try { return fn(); } catch (Exception ex) { // Ignore error exception = ex; retries++; } if (delayMs &gt; 0) { Task.Delay(delayMs).Wait(); } } throw exception!; } What It Looks Like If It Fails Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Message: Your number must not be 3 Source: RetryActionDemo HelpLink: StackTrace: at RetryActionDemo.Program.Main(String[] args) in .... What It Looks Like If It Succeeds Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 1 Number accepted! 1" />
<link rel="canonical" href="http://localhost:4000/retry-action/" />
<meta property="og:url" content="http://localhost:4000/retry-action/" />
<meta property="og:site_name" content="Software Design Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-09-25T09:33:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Retry Action" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-09-25T09:33:00-04:00","datePublished":"2024-09-25T09:33:00-04:00","description":"Let’s retry an action and maybe a function… Keeping in mind, this particular job had a specific rule of not allowing any third-party libraries. Everything had to be done adhoc. The Action Keeps Failing Challenge While working with the team, I often found that tasks would fail due to other problems outside our domain. Often this was due to the SQL server timing out which we couldn’t change. There were sometimes problems where service we were relying on was slow starting up; all of our services would sleep after a mere 5 minutes. We could just keep popping up the error notification and make the user resubmit but even I didn’t like doing that myself. I came up with an idea for going ahead and retrying until there was a definite point to give up. A Retry Function /// &lt;summary&gt; /// Retry a failed action /// &lt;/summary&gt; /// &lt;param name=&quot;action&quot;&gt;Action to perform&lt;/param&gt; /// &lt;param name=&quot;numberOfRetries&quot;&gt;Number of retries&lt;/param&gt; /// &lt;param name=&quot;delayMs&quot;&gt;Delay between reties. Default is no delay.&lt;/param&gt; public static void RetryAction(Action action, int numberOfRetries, int delayMs = 0) { Exception? exception = null; int retries = 0; while (retries &lt; numberOfRetries) { try { action(); return; } catch (Exception ex) { // Ignore error exception = ex; retries++; } if (delayMs &gt; 0) { Task.Delay(delayMs).Wait(); } } throw exception!; } Example public static void ThisMightFail() { const int notAllowed = 1; Console.Write(&quot;Enter a number: &quot;); var input = int.Parse(Console.ReadLine() ?? &quot;0&quot;); if (input == notAllowed) { Console.WriteLine($&quot;You number must not be {notAllowed}&quot;); throw new ArgumentException($&quot;You number must not be {notAllowed}&quot;); } Console.Write(&quot;Number accepted!&quot;); } RetryAction(ThisMightFail /* The action to retry */, 5 /* 5 retries */, 500 /* 1/2 second delay */); What It Looks Like If It Fails Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Message: Your number must not be 1 Source: RetryActionDemo HelpLink: StackTrace: at RetryActionDemo.Program.Main(String[] args) in .... What It Looks Like If It Succeeds Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 1 Your number must not be 1 Enter a number: 2 Number accepted! Okay, what about parameters and return values… public static int GetTheNumber(int notAllowed = 1) { Console.Write(&quot;Enter a number: &quot;); var input = int.Parse(Console.ReadLine() ?? &quot;0&quot;); if (input == notAllowed) { Console.WriteLine($&quot;You number must not be {notAllowed}&quot;); throw new ArgumentException($&quot;You number must not be {notAllowed}&quot;); } Console.Write(&quot;Number accepted!&quot;); return input; } /* This is a wrapper so we can pass a parameter */ public static int ThisMightFail2() { return GetTheNumber(3); } var res = RetryAction(ThisMightFail2 /* The action to retry */, 5 /* 5 retries */, 500 /* 1/2 second delay */); Console.WriteLine(res); The New RetryAction /// &lt;summary&gt; /// Retry a failed function /// &lt;/summary&gt; /// &lt;param name=&quot;fn&quot;&gt;Function to perform&lt;/param&gt; /// &lt;param name=&quot;numberOfRetries&quot;&gt;Number of retries&lt;/param&gt; /// &lt;param name=&quot;delayMs&quot;&gt;Delay between reties. Default is no delay.&lt;/param&gt; public static TResult? RetryAction&lt;TResult&gt;(Func&lt;TResult&gt; fn, int numberOfRetries, int delayMs = 0) { Exception? exception = null; int retries = 0; while (retries &lt; numberOfRetries) { try { return fn(); } catch (Exception ex) { // Ignore error exception = ex; retries++; } if (delayMs &gt; 0) { Task.Delay(delayMs).Wait(); } } throw exception!; } What It Looks Like If It Fails Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Message: Your number must not be 3 Source: RetryActionDemo HelpLink: StackTrace: at RetryActionDemo.Program.Main(String[] args) in .... What It Looks Like If It Succeeds Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 3 Your number must not be 3 Enter a number: 1 Number accepted! 1","headline":"Retry Action","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/retry-action/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/images/MatthewHanna2.jpg"}},"url":"http://localhost:4000/retry-action/"}</script>
<!-- End Jekyll SEO tag -->


  

  <script>
    /* Cut the mustard */
    if ( 'querySelector' in document && 'addEventListener' in window ) {
      document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + 'js';
    }
  </script>

  <link rel="stylesheet" href="/assets/css/main.css">
  <!-- link rel="stylesheet" href="/assets/css/skins/default.css" -->
  <link rel="stylesheet" href="/assets/css/site.css">
  <link rel="stylesheet" href="/assets/css/banner.css">
  <link rel="alternate" type="application/atom+xml" title="Software Design Blog" href="/feed.xml">
<!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">





<!-- end custom head snippets -->

</head>


  <body class="layout--post  retry-action">
    <header>&nbsp;</header>
    
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#primary-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    
  <div class="navigation-wrapper">
    <a href="#menu-toggle" id="menu-toggle">Menu</a>
    <nav id="primary-nav" class="site-nav animated drop">
      <ul><li><a href="/">Home</a></li><li><a href="/posts/">Posts</a></li><li><a href="/categories/">Categories</a></li><li><a href="/tags/">Tags</a></li><li><a href="/search/">Search</a></li><li><a href="https://matthewhanna.net">Resume</a></li><li><a href="https://matthewhanna.com?freelancer">Freelancer</a></li></ul>
    </nav>
  </div><!-- /.navigation-wrapper -->


    <header class="masthead">
  <div class="wrap">
    
      <a href="/" class="site-logo" rel="home" title="Software Design Blog">
        <img src="/images/MatthewHanna2.jpg" class="site-logo-img animated fadeInDown" alt="Software Design Blog">
      </a>
    
    
    
      
        <div class="site-title animated fadeIn"><a href="/">Software Design Blog</a></div>
      
      <p class="site-description animated fadeIn" itemprop="description">Matthew Hanna's software design blog.</p>
    
  </div>
</header><!-- /.masthead -->


    <main id="main" class="main-content" aria-label="Content">
  <article class="h-entry">
    

    <div class="page-wrapper">
      <header class="page-header">
        
        
          <h1 id="page-title" class="page-title p-name">Retry Action
</h1>
        
      </header>

      <div class="page-sidebar">
        <div class="page-author h-card p-author"><div class="author-info">

<span class="read-time">3 min read</span>

    <time class="page-date dt-published" datetime="2024-09-25T09:33:00-04:00"><a class="u-url" href="">September 25, 2024</a>
</time>

  </div>
</div>

        

        
  <h3 class="page-taxonomies-title">Tags</h3>
  <ul class="page-taxonomies"><li class="page-taxonomy"><a href="/tags/#c" title="Pages tagged C#" rel="tag">C#</a></li>
  </ul>


      </div>

      <div id="post-content" class="page-content">
        <div class="e-content">
          <p>Let’s retry an action and maybe a function…</p>

<p>Keeping in mind, this particular job had a specific rule of not allowing any third-party libraries. Everything had to be done adhoc.</p>

<h2 id="the-action-keeps-failing-challenge">The Action Keeps Failing Challenge</h2>
<p>While working with the team, I often found that tasks would fail due to other problems outside our domain. Often this was due to the SQL server timing out which we couldn’t change. There were sometimes problems where service we were relying on was slow starting up; all of our services would sleep after a mere 5 minutes.</p>

<p>We could just keep popping up the error notification and make the user resubmit but even I didn’t like doing that myself. I came up with an idea for going ahead and retrying until there was a definite point to give up.</p>

<p><strong>A Retry Function</strong></p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// Retry a failed action</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="action"&gt;Action to perform&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="numberOfRetries"&gt;Number of retries&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="delayMs"&gt;Delay between reties. Default is no delay.&lt;/param&gt;</span>
<span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RetryAction</span><span class="p">(</span><span class="n">Action</span> <span class="n">action</span><span class="p">,</span> <span class="kt">int</span> <span class="n">numberOfRetries</span><span class="p">,</span> <span class="kt">int</span> <span class="n">delayMs</span> <span class="p">=</span> <span class="m">0</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Exception</span><span class="p">?</span> <span class="n">exception</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">retries</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">retries</span> <span class="p">&lt;</span> <span class="n">numberOfRetries</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">try</span>
        <span class="p">{</span>
            <span class="nf">action</span><span class="p">();</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Ignore error</span>
            <span class="n">exception</span> <span class="p">=</span> <span class="n">ex</span><span class="p">;</span>
            <span class="n">retries</span><span class="p">++;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">delayMs</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Task</span><span class="p">.</span><span class="nf">Delay</span><span class="p">(</span><span class="n">delayMs</span><span class="p">).</span><span class="nf">Wait</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">throw</span> <span class="n">exception</span><span class="p">!;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Example</strong></p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">ThisMightFail</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">notAllowed</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>

    <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="s">"Enter a number: "</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">input</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">()</span> <span class="p">??</span> <span class="s">"0"</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="p">==</span> <span class="n">notAllowed</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"You number must not be </span><span class="p">{</span><span class="n">notAllowed</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentException</span><span class="p">(</span><span class="s">$"You number must not be </span><span class="p">{</span><span class="n">notAllowed</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="s">"Number accepted!"</span><span class="p">);</span>
<span class="p">}</span>

<span class="nf">RetryAction</span><span class="p">(</span><span class="n">ThisMightFail</span> <span class="cm">/* The action to retry */</span><span class="p">,</span>
            <span class="m">5</span> <span class="cm">/* 5 retries */</span><span class="p">,</span>
            <span class="m">500</span> <span class="cm">/* 1/2 second delay */</span><span class="p">);</span>
</code></pre></div></div>

<p><strong>What It Looks Like If It Fails</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Enter a number: 1
Your number must not be 1
Enter a number: 1
Your number must not be 1
Enter a number: 1
Your number must not be 1
Enter a number: 1
Your number must not be 1
Enter a number: 1
Message: Your number must not be 1
Source: RetryActionDemo
HelpLink:
StackTrace: at RetryActionDemo.Program.Main(String[] args) in ....
</code></pre></div></div>

<p><strong>What It Looks Like If It Succeeds</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Enter a number: 1
Your number must not be 1
Enter a number: 1
Your number must not be 1
Enter a number: 1
Your number must not be 1
Enter a number: 1
Your number must not be 1
Enter a number: 2
Number accepted!
</code></pre></div></div>

<p><strong>Okay, what about parameters and return values…</strong></p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">static</span> <span class="kt">int</span> <span class="nf">GetTheNumber</span><span class="p">(</span><span class="kt">int</span> <span class="n">notAllowed</span> <span class="p">=</span> <span class="m">1</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="s">"Enter a number: "</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">input</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">()</span> <span class="p">??</span> <span class="s">"0"</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">input</span> <span class="p">==</span> <span class="n">notAllowed</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"You number must not be </span><span class="p">{</span><span class="n">notAllowed</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentException</span><span class="p">(</span><span class="s">$"You number must not be </span><span class="p">{</span><span class="n">notAllowed</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="s">"Number accepted!"</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">input</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* This is a wrapper so we can pass a parameter */</span>
<span class="k">public</span> <span class="k">static</span> <span class="kt">int</span> <span class="nf">ThisMightFail2</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nf">GetTheNumber</span><span class="p">(</span><span class="m">3</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">var</span> <span class="n">res</span> <span class="p">=</span> <span class="nf">RetryAction</span><span class="p">(</span><span class="n">ThisMightFail2</span> <span class="cm">/* The action to retry */</span><span class="p">,</span>
                      <span class="m">5</span> <span class="cm">/* 5 retries */</span><span class="p">,</span>
                      <span class="m">500</span> <span class="cm">/* 1/2 second delay */</span><span class="p">);</span>
<span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
</code></pre></div></div>

<p><strong>The New RetryAction</strong></p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// Retry a failed function</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="fn"&gt;Function to perform&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="numberOfRetries"&gt;Number of retries&lt;/param&gt;</span>
<span class="c1">/// &lt;param name="delayMs"&gt;Delay between reties. Default is no delay.&lt;/param&gt;</span>
<span class="k">public</span> <span class="k">static</span> <span class="n">TResult</span><span class="p">?</span> <span class="n">RetryAction</span><span class="p">&lt;</span><span class="n">TResult</span><span class="p">&gt;(</span><span class="n">Func</span><span class="p">&lt;</span><span class="n">TResult</span><span class="p">&gt;</span> <span class="n">fn</span><span class="p">,</span> <span class="kt">int</span> <span class="n">numberOfRetries</span><span class="p">,</span> <span class="kt">int</span> <span class="n">delayMs</span> <span class="p">=</span> <span class="m">0</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Exception</span><span class="p">?</span> <span class="n">exception</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">retries</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">retries</span> <span class="p">&lt;</span> <span class="n">numberOfRetries</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">try</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nf">fn</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Ignore error</span>
            <span class="n">exception</span> <span class="p">=</span> <span class="n">ex</span><span class="p">;</span>
            <span class="n">retries</span><span class="p">++;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">delayMs</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Task</span><span class="p">.</span><span class="nf">Delay</span><span class="p">(</span><span class="n">delayMs</span><span class="p">).</span><span class="nf">Wait</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">throw</span> <span class="n">exception</span><span class="p">!;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>What It Looks Like If It Fails</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Enter a number: 3
Your number must not be 3
Enter a number: 3
Your number must not be 3
Enter a number: 3
Your number must not be 3
Enter a number: 3
Your number must not be 3
Enter a number: 3
Message: Your number must not be 3
Source: RetryActionDemo
HelpLink:
StackTrace: at RetryActionDemo.Program.Main(String[] args) in ....
</code></pre></div></div>

<p><strong>What It Looks Like If It Succeeds</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Enter a number: 3
Your number must not be 3
Enter a number: 3
Your number must not be 3
Enter a number: 3
Your number must not be 3
Enter a number: 3
Your number must not be 3
Enter a number: 1
Number accepted!
1
</code></pre></div></div>

        </div>

        
          <div class="page-share">
  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fretry-action%2F" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" class="btn btn--facebook btn--small"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i> <span>Share</span></a>
  <a href="https://twitter.com/intent/tweet?text=Retry+Action%20http%3A%2F%2Flocalhost%3A4000%2Fretry-action%2F" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" class="btn btn--twitter btn--small"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i> <span>Tweet</span></a>
  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fretry-action%2F" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" class="btn btn--linkedin btn--small"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> <span>LinkedIn</span></a>
  <a href="https://reddit.com/submit?title=Retry+Action&url=http%3A%2F%2Flocalhost%3A4000%2Fretry-action%2F" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" class="btn btn--reddit btn--small"><i class="fab fa-fw fa-reddit" aria-hidden="true"></i> <span>Reddit</span></a>
</div>

        

        
          

        

        <nav class="page-pagination" role="navigation">
  
    <a class="page-previous" href="/data-redaction-replace/">
      <h4 class="page-pagination-label">Previous</h4>
      <span class="page-pagination-title">
        <i class="fas fa-arrow-left"></i> Data Redaction - Replace

      </span>
    </a>
  

  
    <a class="page-next" href="/msbuild-git-branch/">
      <h4 class="page-pagination-label">Next</h4>
      <span class="page-pagination-title">
        Using A Git Branch In MSBuild
 <i class="fas fa-arrow-right"></i>
      </span>
    </a>
  
</nav>

      </div>
    </div>
  </article>
</main>


    <footer id="footer" class="site-footer">
  <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
<div class="social-icons"><a class="social-icon" href="https://github.com/irtheman"><i class="fab fa-github-square fa-2x" title="GitHub"></i></a><a class="social-icon" href="/feed.xml"><i class="fas fa-rss-square fa-2x" title="Feed"></i></a></div><div class="copyright">
    
      <p>&copy; 2026 Software Design Blog. Powered by Matthew Hanna.</p>
    
  </div>
</footer>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="/assets/js/main.min.js"></script>
  <script src="/assets/js/banner.js" type="module"></script>
  <script src="https://use.fontawesome.com/releases/v5.0.12/js/all.js"></script>


  </body>

</html>
